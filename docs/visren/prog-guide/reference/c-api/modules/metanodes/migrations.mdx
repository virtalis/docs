---
title: Migrations
summary: Functions for defining metanode migrations. 
---

# Migrations

**Module:** **[Metanodes](../metanodes/index.mdx)**

Functions for defining metanode migrations. 

## Functions

| Type           | Name           |
| -------------- | -------------- |
| int | **[VRAddInstanceMigration](#vraddinstancemigration)**([HNode](../../definitions/types.mdx#typedef-hnode) node, [MigrationFunc](../../definitions/function-prototypes.mdx#typedef-migrationfunc) func, void * userData) |
| int | **[VRAddMigration](#vraddmigration)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, [MigrationAddFunc](../../definitions/function-prototypes.mdx#typedef-migrationaddfunc) func)<br />Adds a migration to the ordered list of migrations applied to the metanode.  |
| int | **[VRChangePropertyArrayBool](#vrchangepropertyarraybool)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, int numElements)<br />Changes the specified property to a VR_BOOL array type.  |
| int | **[VRChangePropertyArrayChar](#vrchangepropertyarraychar)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, int numElements)<br />Changes the specified property to a VR_CHAR array type.  |
| int | **[VRChangePropertyArrayDouble](#vrchangepropertyarraydouble)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, int numElements)<br />Changes the specified property to a VR_DOUBLE array type.  |
| int | **[VRChangePropertyArrayFloat](#vrchangepropertyarrayfloat)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, int numElements)<br />Changes the specified property to a VR_FLOAT array type.  |
| int | **[VRChangePropertyArrayInt](#vrchangepropertyarrayint)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, int numElements)<br />Changes the specified property to a VR_INT array type.  |
| int | **[VRChangePropertyArrayWorldFloat](#vrchangepropertyarrayworldfloat)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, int numElements)<br />Changes the specified property to a VR_WORLD_FLOAT array type.  |
| int | **[VRChangePropertyBool](#vrchangepropertybool)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_BOOL type.  |
| int | **[VRChangePropertyChar](#vrchangepropertychar)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_CHAR type.  |
| int | **[VRChangePropertyDouble](#vrchangepropertydouble)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_DOUBLE type.  |
| int | **[VRChangePropertyFloat](#vrchangepropertyfloat)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_FLOAT type.  |
| int | **[VRChangePropertyInt](#vrchangepropertyint)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_INT type.  |
| int | **[VRChangePropertyLink](#vrchangepropertylink)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_LINK type.  |
| int | **[VRChangePropertyName](#vrchangepropertyname)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName, const char * newPropName)<br />Renames a property.  |
| int | **[VRChangePropertyString](#vrchangepropertystring)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_STRING type.  |
| int | **[VRChangePropertyVectorChar](#vrchangepropertyvectorchar)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to a VR_VEC_CHAR type.  |
| int | **[VRChangePropertyVectorFloat](#vrchangepropertyvectorfloat)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to a VR_VEC_FLOAT type.  |
| int | **[VRChangePropertyVectorInt](#vrchangepropertyvectorint)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to a VR_VEC_INT type.  |
| int | **[VRChangePropertyVectorString](#vrchangepropertyvectorstring)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to a VR_VEC_STRING type.  |
| int | **[VRChangePropertyVectorWorldFloat](#vrchangepropertyvectorworldfloat)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to a VR_VEC_WORLD_FLOAT type.  |
| int | **[VRChangePropertyWorldFloat](#vrchangepropertyworldfloat)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propName)<br />Changes the specified property to single element VR_WORLD_FLOAT type.  |
| void | **[VRCloseMigrationHandle](#vrclosemigrationhandle)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration)<br />Closes a migration handle.  |
| int | **[VRMigrationCopyKnownProperties](#vrmigrationcopyknownproperties)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [HNode](../../definitions/types.mdx#typedef-hnode) old, [HNode](../../definitions/types.mdx#typedef-hnode) newNode)<br />Copies values of all properties that exist on both new and old node versions of the nodes. The nodes must be the same basic type, but may be different versions of that type. Properties that do not match in name or type between the versions are left for the migration implementation to handle.  |
| [HNode](../../definitions/types.mdx#typedef-hnode) | **[VRMigrationCreateCurrentNode](#vrmigrationcreatecurrentnode)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [HNode](../../definitions/types.mdx#typedef-hnode) node)<br />Creates an instance of a node using the metanode version defined by this migration.  |
| int | **[VRMigrationFinish](#vrmigrationfinish)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [HNode](../../definitions/types.mdx#typedef-hnode) old, [HNode](../../definitions/types.mdx#typedef-hnode) newNode)<br />Helper function for completing a migration step. This function moves all children of old to newNode, deletes old, and closes its handle.  |
| [HMigration](../../definitions/types.mdx#typedef-hmigration) | **[VRMigrationNext](#vrmigrationnext)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration)<br />Gets the next migration in the chain (the one for the version after this one)  |
| [HNode](../../definitions/types.mdx#typedef-hnode) | **[VRMigrationPrepareNode](#vrmigrationpreparenode)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [HNode](../../definitions/types.mdx#typedef-hnode) node)<br />Calls the registered upgrade node function of the migration previous or next to this one (depending on whether node is older or newer than migration). This effectively brings node up to date, ready for this migration to perform its upgrade.  |
| [HMigration](../../definitions/types.mdx#typedef-hmigration) | **[VRMigrationPrev](#vrmigrationprev)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration)<br />Gets the previous migration in the chain (the one for the version before this one)  |
| int | **[VRRemoveProperty](#vrremoveproperty)**([HMeta](../../definitions/types.mdx#typedef-hmeta) metaNode, const char * propertyName)<br />Removes a property from a metanode.  |
| int | **[VRSetMigrationDown](#vrsetmigrationdown)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [MigrationDownFunc](../../definitions/function-prototypes.mdx#typedef-migrationdownfunc) func)<br />Adds a downgrade function to a migration.  |
| int | **[VRSetMigrationDowngradeNode](#vrsetmigrationdowngradenode)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [MigrationDowngradeFunc](../../definitions/function-prototypes.mdx#typedef-migrationdowngradefunc) func)<br />Adds a node downgrade function to a migration.  |
| int | **[VRSetMigrationUp](#vrsetmigrationup)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [MigrationUpFunc](../../definitions/function-prototypes.mdx#typedef-migrationupfunc) func)<br />Adds an upgrade function to a migration.  |
| int | **[VRSetMigrationUpgradeNode](#vrsetmigrationupgradenode)**([HMigration](../../definitions/types.mdx#typedef-hmigration) migration, [MigrationUpgradeFunc](../../definitions/function-prototypes.mdx#typedef-migrationupgradefunc) func)<br />Adds a node upgrade function to a migration.  |

## Functions Documentation

### VRAddInstanceMigration

```cpp
int VRAddInstanceMigration(
    HNode node,
    MigrationFunc func,
    void * userData
)
```

### VRAddMigration

```cpp
int VRAddMigration(
    HMeta metaNode,
    MigrationAddFunc func
)
```

Adds a migration to the ordered list of migrations applied to the metanode. 

**Parameters**: 

  * **metaNode** handle to the metanode to modify 
  * **func** function to call to register the migration specifics. This function is called immediately. 

**Return**: 0 if the migration is added successfully. 

The function provided is expected to be implemented to call VRSetMigration functions. ([VRSetMigrationUp](#vrsetmigrationup), [VRSetMigrationDown](#vrsetmigrationdown), [VRSetMigrationUpgradeNode](#vrsetmigrationupgradenode), [VRSetMigrationDowngradeNode](#vrsetmigrationdowngradenode))

The number of calls to this function during metanode creation defines the version number of the metanode.

Migrations can only be added to uninstantiated metanodes.

### VRChangePropertyArrayBool

```cpp
int VRChangePropertyArrayBool(
    HMeta metaNode,
    const char * propName,
    int numElements
)
```

Changes the specified property to a VR_BOOL array type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 
  * **numElements** number of elements in the new array property 

**Return**: 0 on success 

### VRChangePropertyArrayChar

```cpp
int VRChangePropertyArrayChar(
    HMeta metaNode,
    const char * propName,
    int numElements
)
```

Changes the specified property to a VR_CHAR array type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 
  * **numElements** number of elements in the new array property 

**Return**: 0 on success 

### VRChangePropertyArrayDouble

```cpp
int VRChangePropertyArrayDouble(
    HMeta metaNode,
    const char * propName,
    int numElements
)
```

Changes the specified property to a VR_DOUBLE array type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 
  * **numElements** number of elements in the new array property 

**Return**: 0 on success 

### VRChangePropertyArrayFloat

```cpp
int VRChangePropertyArrayFloat(
    HMeta metaNode,
    const char * propName,
    int numElements
)
```

Changes the specified property to a VR_FLOAT array type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 
  * **numElements** number of elements in the new array property 

**Return**: 0 on success 

### VRChangePropertyArrayInt

```cpp
int VRChangePropertyArrayInt(
    HMeta metaNode,
    const char * propName,
    int numElements
)
```

Changes the specified property to a VR_INT array type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 
  * **numElements** number of elements in the new array property 

**Return**: 0 on success 

### VRChangePropertyArrayWorldFloat

```cpp
int VRChangePropertyArrayWorldFloat(
    HMeta metaNode,
    const char * propName,
    int numElements
)
```

Changes the specified property to a VR_WORLD_FLOAT array type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 
  * **numElements** number of elements in the new array property 

**Return**: 0 on success 

### VRChangePropertyBool

```cpp
int VRChangePropertyBool(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_BOOL type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyChar

```cpp
int VRChangePropertyChar(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_CHAR type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyDouble

```cpp
int VRChangePropertyDouble(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_DOUBLE type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyFloat

```cpp
int VRChangePropertyFloat(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_FLOAT type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyInt

```cpp
int VRChangePropertyInt(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_INT type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyLink

```cpp
int VRChangePropertyLink(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_LINK type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyName

```cpp
int VRChangePropertyName(
    HMeta metaNode,
    const char * propName,
    const char * newPropName
)
```

Renames a property. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** the name of the property to rename 
  * **newPropName** the new name of the property 

**Return**: 0 on success 

### VRChangePropertyString

```cpp
int VRChangePropertyString(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_STRING type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyVectorChar

```cpp
int VRChangePropertyVectorChar(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to a VR_VEC_CHAR type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyVectorFloat

```cpp
int VRChangePropertyVectorFloat(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to a VR_VEC_FLOAT type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyVectorInt

```cpp
int VRChangePropertyVectorInt(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to a VR_VEC_INT type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyVectorString

```cpp
int VRChangePropertyVectorString(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to a VR_VEC_STRING type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyVectorWorldFloat

```cpp
int VRChangePropertyVectorWorldFloat(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to a VR_VEC_WORLD_FLOAT type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRChangePropertyWorldFloat

```cpp
int VRChangePropertyWorldFloat(
    HMeta metaNode,
    const char * propName
)
```

Changes the specified property to single element VR_WORLD_FLOAT type. 

**Parameters**: 

  * **metaNode** handle to the metanode to change 
  * **propName** name of the property to change 

**Return**: 0 on success 

### VRCloseMigrationHandle

```cpp
void VRCloseMigrationHandle(
    HMigration migration
)
```

Closes a migration handle. 

**Parameters**: 

  * **migration** the handle to close 

### VRMigrationCopyKnownProperties

```cpp
int VRMigrationCopyKnownProperties(
    HMigration migration,
    HNode old,
    HNode newNode
)
```

Copies values of all properties that exist on both new and old node versions of the nodes. The nodes must be the same basic type, but may be different versions of that type. Properties that do not match in name or type between the versions are left for the migration implementation to handle. 

**Parameters**: 

  * **migration** migration handle 
  * **old** the old version of the node (source) 
  * **newNode** the new node to copy into (dest) 

**Return**: 0 on success 

### VRMigrationCreateCurrentNode

```cpp
HNode VRMigrationCreateCurrentNode(
    HMigration migration,
    HNode node
)
```

Creates an instance of a node using the metanode version defined by this migration. 

### VRMigrationFinish

```cpp
int VRMigrationFinish(
    HMigration migration,
    HNode old,
    HNode newNode
)
```

Helper function for completing a migration step. This function moves all children of old to newNode, deletes old, and closes its handle. 

**Parameters**: 

  * **migration** the migration being completed 
  * **old** the node to clear and delete 
  * **newNode** the new parent of the children being moved 

**Return**: 0 on success 

### VRMigrationNext

```cpp
HMigration VRMigrationNext(
    HMigration migration
)
```

Gets the next migration in the chain (the one for the version after this one) 

**Parameters**: 

  * **migration** handle to the migration 

**Return**: the next migration or NULL if this is the newest one 

### VRMigrationPrepareNode

```cpp
HNode VRMigrationPrepareNode(
    HMigration migration,
    HNode node
)
```

Calls the registered upgrade node function of the migration previous or next to this one (depending on whether node is older or newer than migration). This effectively brings node up to date, ready for this migration to perform its upgrade. 

**Parameters**: 

  * **migration** handle to the migration 
  * **node** the node to transform to the version of this migration 

**Return**: handle to the node at the requested version. 

### VRMigrationPrev

```cpp
HMigration VRMigrationPrev(
    HMigration migration
)
```

Gets the previous migration in the chain (the one for the version before this one) 

**Parameters**: 

  * **migration** handle to the migration 

**Return**: the previous migration or NULL if this is the oldest one 

### VRRemoveProperty

```cpp
int VRRemoveProperty(
    HMeta metaNode,
    const char * propertyName
)
```

Removes a property from a metanode. 

**Parameters**: 

  * **metaNode** handle to the metanode to modify 
  * **propertyName** name of the property to remove 

**Return**: 0 if property is removed 

### VRSetMigrationDown

```cpp
int VRSetMigrationDown(
    HMigration migration,
    MigrationDownFunc func
)
```

Adds a downgrade function to a migration. 

**Parameters**: 

  * **migration** handle to migration to modify 
  * **func** function implementing the downgrade. the implementation need not close the handle parameters. 

**Return**: 0 if the function is added successfully 

### VRSetMigrationDowngradeNode

```cpp
int VRSetMigrationDowngradeNode(
    HMigration migration,
    MigrationDowngradeFunc func
)
```

Adds a node downgrade function to a migration. 

**Parameters**: 

  * **migration** handle to migration to modify 
  * **func** function implementing the downgrade. the implementation need not close the handle parameters. 

**Return**: 0 if the function is added successfully 

### VRSetMigrationUp

```cpp
int VRSetMigrationUp(
    HMigration migration,
    MigrationUpFunc func
)
```

Adds an upgrade function to a migration. 

**Parameters**: 

  * **migration** handle to migration to modify 
  * **func** function implementing the upgrade. the implementation need not close the handle parameters. 

**Return**: 0 if the function is added successfully 

### VRSetMigrationUpgradeNode

```cpp
int VRSetMigrationUpgradeNode(
    HMigration migration,
    MigrationUpgradeFunc func
)
```

Adds a node upgrade function to a migration. 

**Parameters**: 

  * **migration** handle to migration to modify 
  * **func** function implementing the upgrade. the implementation need not close the handle parameters. 

**Return**: 0 if the function is added successfully 
