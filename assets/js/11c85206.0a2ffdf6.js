"use strict";(self.webpackChunkvirtalis_docs=self.webpackChunkvirtalis_docs||[]).push([[68735],{89458:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>m,frontMatter:()=>o,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"visionary-render-programming/scripts/advanced/lua-odbc","title":"Using LuaSQL for ODBC Connections","description":"Installing a MySQL server (optional, when you don\'t already have one)","source":"@site/docs/visionary-render-programming/scripts/advanced/lua-odbc.mdx","sourceDirName":"visionary-render-programming/scripts/advanced","slug":"/visionary-render-programming/scripts/advanced/lua-odbc","permalink":"/visionary-render-programming/scripts/advanced/lua-odbc","draft":false,"unlisted":false,"editUrl":"https://github.com/virtalis/docs/tree/master/docs/visionary-render-programming/scripts/advanced/lua-odbc.mdx","tags":[],"version":"current","lastUpdatedAt":1744797866000,"frontMatter":{},"sidebar":"visionaryRenderProgrammingSidebar","previous":{"title":"Reference External Data Using the COM","permalink":"/visionary-render-programming/scripts/advanced/lua-com"},"next":{"title":"Terminating Long Scripts","permalink":"/visionary-render-programming/scripts/advanced/terminating-long-scripts"}}');var s=r(74848),t=r(28453);const o={},i="Using LuaSQL for ODBC Connections",l={},d=[{value:"Installing a MySQL server (optional, when you don&#39;t already have one)",id:"installing-a-mysql-server-optional-when-you-dont-already-have-one",level:2},{value:"Installing and setting up the ODBC driver.",id:"installing-and-setting-up-the-odbc-driver",level:2},{value:"Example Code",id:"example-code",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.R)(),...e.components},{Steps:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Steps",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"using-luasql-for-odbc-connections",children:"Using LuaSQL for ODBC Connections"})}),"\n",(0,s.jsx)(n.h2,{id:"installing-a-mysql-server-optional-when-you-dont-already-have-one",children:"Installing a MySQL server (optional, when you don't already have one)"}),"\n",(0,s.jsx)(r,{children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Install a ",(0,s.jsx)(n.a,{href:"https://dev.mysql.com/downloads/mysql/",children:"mysql server"})," on your machine or on a network."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Run "MySQL 5.5 Command Line Client" from the start menu.'}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Create a database by typing "CREATE DATABASE myDataBase;" and pressing enter.'}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"installing-and-setting-up-the-odbc-driver",children:"Installing and setting up the ODBC driver."}),"\n",(0,s.jsx)(r,{children:(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Download and install the ",(0,s.jsx)(n.a,{href:"https://dev.mysql.com/downloads/connector/odbc/",children:"MySQL ODBC driver"})," from"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Run "Data Sources (ODBC)" from the start menu.'}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Go to the "System DSN" tab.'}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'Click the "Add" button.'}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Enter the connection settings for your MySQL database (make sure you made a database first)."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:'The "Data Source Name" is the name you must use when connecting to this database using odbc in lua.'}),"\n"]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"example-code",children:"Example Code"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-lua",children:'env = assert(luasql.odbc())\r\ncon = assert(env:connect("My_ODBC_Data_Source_Name"))\r\n\r\nres = con:execute("DROP TABLE people")\r\nres = assert (con:execute("CREATE TABLE people(name  varchar(50), email varchar(50))")\r\n\r\n-- add a few elements\r\nlist = {\r\n  { name="Jose das Couves", email="jose@couves.com" },\r\n  { name="Manoel Joaquim", email="manoel.joaquim@cafundo.com" },\r\n  { name="Maria das Dores", email="maria@dores.com" },\r\n}\r\n\r\nfor i, p in pairs (list) do\r\n  res = assert (con:execute(string.format("INSERT INTO people VALUES (\'%s\', \'%s\')", p.name, p.email)))\r\nend\r\n\r\n-- retrieve a cursor\r\ncur = assert (con:execute("SELECT name, email from people"))\r\n\r\n-- print all rows\r\nrow = cur:fetch ({}, "a")-- the rows will be indexed by field names\r\nwhile row do\r\n  print(string.format("Name: %s, E-mail: %s", row.name, row.email))\r\n  row = cur:fetch (row, "a")-- reusing the table of results\r\nend\r\n\r\n-- close everything\r\ncur:close()\r\ncon:close()\r\nenv:close()\n'})}),"\n",(0,s.jsx)(n.p,{children:'You can confirm that this wrote data to the MySQL database by opening the "MySQL 5.5 Command Line Client" from the start menu and entering'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"mysql> use myDataBaseName;\r\nmysql> SELECT * FROM people;\n"})}),"\n",(0,s.jsx)(n.p,{children:"This should show the contents written to the database from the lua script."})]})}function m(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>i});var a=r(96540);const s={},t=a.createContext(s);function o(e){const n=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(t.Provider,{value:n},e.children)}}}]);