"use strict";(self.webpackChunkvirtalis_docs=self.webpackChunkvirtalis_docs||[]).push([[10598],{68219:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>u,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"visionary-render-programming/plugins/advanced/dynamic-loading","title":"Dynamic Loading","description":"Plugins can be loaded and unloaded dynamically, by using the Plugins interface in the Settings window. All plugins, if they start unloaded, can be loaded at any time via this interface, regardless of whether any special considerations are made within the plugin.","source":"@site/docs/visionary-render-programming/plugins/advanced/dynamic-loading.mdx","sourceDirName":"visionary-render-programming/plugins/advanced","slug":"/visionary-render-programming/plugins/advanced/dynamic-loading","permalink":"/visionary-render-programming/plugins/advanced/dynamic-loading","draft":false,"unlisted":false,"editUrl":"https://github.com/virtalis/docs/tree/master/docs/visionary-render-programming/plugins/advanced/dynamic-loading.mdx","tags":[],"version":"current","lastUpdatedAt":1730817102000,"frontMatter":{},"sidebar":"visionaryRenderProgrammingSidebar","previous":{"title":"Dependencies","permalink":"/visionary-render-programming/plugins/advanced/dependencies"},"next":{"title":"Coroutines in Lua Plugins","permalink":"/visionary-render-programming/plugins/advanced/lua-coroutines"}}');var r=a(74848),i=a(28453),l=a(65537),s=a(79329);const o={},u="Dynamic Loading",c={},d=[];function p(e){const n={code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"dynamic-loading",children:"Dynamic Loading"})}),"\n",(0,r.jsx)(n.p,{children:"Plugins can be loaded and unloaded dynamically, by using the Plugins interface in the Settings window. All plugins, if they start unloaded, can be loaded at any time via this interface, regardless of whether any special considerations are made within the plugin."}),"\n",(0,r.jsx)(n.p,{children:'When attempting to unload plugins, those that do not implement their own cleanup procedures will not unload until the next application restart, in which case they will not be loaded automatically when the application starts up. The plugin manager interface will display a "Restart Required" message if the user attempts to unload a plugin without a cleanup function.'}),"\n",(0,r.jsxs)(n.p,{children:["In order to make a plugin support unloading, it must implement ",(0,r.jsx)(n.code,{children:"VRPCleanupProc"}),"."]}),"\n",(0,r.jsxs)(l.A,{children:[(0,r.jsx)(s.A,{value:"cpp",label:"C++",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"PLUGIN_ENTRY_POINT int VRTREE_APIENTRY VRPCleanup()\r\n{\r\n  //clean things\r\n  return 0;\r\n}\n"})})}),(0,r.jsx)(s.A,{value:"lua",label:"Lua",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"local function cleanup()\r\n  -- clean things\r\nend\r\n\r\nreturn {\r\n  -- alongside existing exports\r\n  cleanup = cleanup\r\n}\n"})})})]}),"\n",(0,r.jsx)(n.p,{children:"The presence of this function lets the plugin loader know that the plugin can be unloaded dynamically, so it is important that the implementation correctly cleans up its resources and hooks."}),"\n",(0,r.jsx)(n.p,{children:"Examples of things that should be cleaned up include:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Callback functions such as those given to ",(0,r.jsx)(n.code,{children:"VRRegisterEventFunction"}),", or any other callback registration mechanism should be unregistered"]}),"\n",(0,r.jsx)(n.li,{children:"Menus created / injected into application menus should be removed and deleted"}),"\n",(0,r.jsx)(n.li,{children:"Any internal allocations made by the plugin should be deleted - simply unloading the plugin does not automatically free any memory it allocated"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"However, it may be necessary to ensure that a plugin cannot be enabled/disabled during runtime."}),"\n",(0,r.jsx)(n.p,{children:'Plugins that should not be enabled/disabled during run time should implement their own locked function, returning "true" if the state of the plugin is not be changed during runtime.'}),"\n",(0,r.jsxs)(l.A,{children:[(0,r.jsx)(s.A,{value:"cpp",label:"C++",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"PLUGIN_ENTRY_POINT bool VRTREE_APIENTRY VRPLocked()\r\n{\r\n  return true;\r\n}\n"})})}),(0,r.jsx)(s.A,{value:"lua",label:"Lua",children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"local function locked()\r\n  return true\r\nend\r\n\r\nreturn {\r\n  -- alongside existing exports\r\n  locked = locked\r\n}\n"})})})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},79329:(e,n,a)=>{a.d(n,{A:()=>l});a(96540);var t=a(34164);const r={tabItem:"tabItem_Ymn6"};var i=a(74848);function l({children:e,hidden:n,className:a}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,t.A)(r.tabItem,a),hidden:n,children:e})}},65537:(e,n,a)=>{a.d(n,{A:()=>w});var t=a(96540),r=a(34164),i=a(65627),l=a(56347),s=a(50372),o=a(30604),u=a(11861),c=a(78749);function d(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:a}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return d(e).map((({props:{value:e,label:n,attributes:a,default:t}})=>({value:e,label:n,attributes:a,default:t})))}(a);return function(e){const n=(0,u.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function h({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const a=(0,l.W6)(),r=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,o.aZ)(r),(0,t.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(a.location.search);n.set(r,e),a.replace({...a.location,search:n.toString()})}),[r,a])]}function g(e){const{defaultValue:n,queryString:a=!1,groupId:r}=e,i=p(e),[l,o]=(0,t.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:n,tabValues:i}))),[u,d]=m({queryString:a,groupId:r}),[g,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[a,r]=(0,c.Dv)(n);return[a,(0,t.useCallback)((e=>{n&&r.set(e)}),[n,r])]}({groupId:r}),b=(()=>{const e=u??g;return h({value:e,tabValues:i})?e:null})();(0,s.A)((()=>{b&&o(b)}),[b]);return{selectedValue:l,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),f(e)}),[d,f,i]),tabValues:i}}var f=a(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=a(74848);function y({className:e,block:n,selectedValue:a,selectValue:t,tabValues:l}){const s=[],{blockElementScrollPositionUntilNextRender:o}=(0,i.a_)(),u=e=>{const n=e.currentTarget,r=s.indexOf(n),i=l[r].value;i!==a&&(o(n),t(i))},c=e=>{let n=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const a=s.indexOf(e.currentTarget)+1;n=s[a]??s[0];break}case"ArrowLeft":{const a=s.indexOf(e.currentTarget)-1;n=s[a]??s[s.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":n},e),children:l.map((({value:e,label:n,attributes:t})=>(0,v.jsx)("li",{role:"tab",tabIndex:a===e?0:-1,"aria-selected":a===e,ref:e=>{s.push(e)},onKeyDown:c,onClick:u,...t,className:(0,r.A)("tabs__item",b.tabItem,t?.className,{"tabs__item--active":a===e}),children:n??e},e)))})}function x({lazy:e,children:n,selectedValue:a}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find((e=>e.props.value===a));return e?(0,t.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function j(e){const n=g(e);return(0,v.jsxs)("div",{className:(0,r.A)("tabs-container",b.tabList),children:[(0,v.jsx)(y,{...n,...e}),(0,v.jsx)(x,{...n,...e})]})}function w(e){const n=(0,f.A)();return(0,v.jsx)(j,{...e,children:d(e.children)},String(n))}},28453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>s});var t=a(96540);const r={},i=t.createContext(r);function l(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);