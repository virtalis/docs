"use strict";(self.webpackChunkvirtalis_docs=self.webpackChunkvirtalis_docs||[]).push([[6196],{45261:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>u,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"visionary-render-programming/plugins/advanced/dependencies","title":"Dependencies","description":"For plugins that require functionality from another plugin, the dependency system can be used to ensure that all dependencies are initialised before this plugin. They do this by implementing VRPDependsProc (native) or depends() (lua).","source":"@site/docs/visionary-render-programming/plugins/advanced/dependencies.mdx","sourceDirName":"visionary-render-programming/plugins/advanced","slug":"/visionary-render-programming/plugins/advanced/dependencies","permalink":"/visionary-render-programming/plugins/advanced/dependencies","draft":false,"unlisted":false,"editUrl":"https://github.com/virtalis/docs/tree/master/docs/visionary-render-programming/plugins/advanced/dependencies.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"visionaryRenderProgrammingSidebar","previous":{"title":"Implement an Update Function","permalink":"/visionary-render-programming/plugins/tutorials/update-function"},"next":{"title":"Dynamic Loading","permalink":"/visionary-render-programming/plugins/advanced/dynamic-loading"}}');var a=r(74848),i=r(28453),s=r(65537),l=r(79329);const o={},u="Dependencies",c={},d=[{value:"Example",id:"example",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"dependencies",children:"Dependencies"})}),"\n",(0,a.jsxs)(n.p,{children:["For plugins that require functionality from another plugin, the dependency system can be used to ensure that all dependencies are initialised before this plugin. They do this by implementing ",(0,a.jsx)(n.code,{children:"VRPDependsProc"})," (native) or ",(0,a.jsx)(n.code,{children:"depends()"})," (lua)."]}),"\n",(0,a.jsxs)(n.p,{children:["Plugin dependencies can be specified simply by naming the plugin that this plugin depends on. This can be in the form of the name reported by the other plugin (from its ",(0,a.jsx)(n.code,{children:"VRPNameProc"})," function), or in the form of the file name (e.g. ",(0,a.jsx)(n.code,{children:"someplugin.lua"}),")."]}),"\n",(0,a.jsxs)(n.p,{children:["For Lua plugins, the use of ",(0,a.jsx)(n.code,{children:"require"})," can be used to load external Lua libraries, but should not be used to require other Lua plugins loaded into the application. Instead, use the dependency system, which loads and initialises the required plugins in the correct order."]}),"\n",(0,a.jsx)(n.h2,{id:"example",children:"Example"}),"\n",(0,a.jsx)(n.p,{children:"Consider two plugins, Plugin A and Plugin B. In order to make Plugin B be loaded before Plugin A, A specifies a dependency."}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(l.A,{value:"cpp",label:"C++",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:'#include <vrtree_api.h>\r\n\r\n// Implement the standard API functions for application hook registration\r\nVRPLUGIN_API_IMPL;\r\n\r\nPLUGIN_ENTRY_POINT const char* VRTREE_APIENTRY VRPName()\r\n{\r\n  return "Plugin A";\r\n}\r\n\r\nPLUGIN_ENTRY_POINT const char* VRTREE_APIENTRY VRPVersion()\r\n{\r\n  return "1.0.0";\r\n}\r\n\r\n// Implement VRPInit to respond to application startup\r\nPLUGIN_ENTRY_POINT int VRTREE_APIENTRY VRPInit()\r\n{\r\n  VRPLUGIN_LOADVRTREE;\r\n\r\n  if (s_logFunc)\r\n    s_logFunc(LOG_INFO, "Plugin A initialising!");\r\n\r\n  return 0;\r\n}\r\n\r\nPLUGIN_ENTRY_POINT int VRTREE_APIENTRY VRPCleanup()\r\n{\r\n  return 0;\r\n}\r\n\r\nPLUGIN_ENTRY_POINT const char* VRTREE_APIENTRY VRPDepends()\r\n{\r\n  return "Plugin B";\r\n}\n'})})}),(0,a.jsx)(l.A,{value:"lua",label:"Lua",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'local modname = ...\r\nlocal _G = _G\r\nmodule(modname)\r\n\r\nfunction name()\r\n  return "Plugin A"\r\nend\r\n\r\nfunction version()\r\n  return "1.0.0"\r\nend\r\n\r\nfunction init()\r\n  _G.print("Plugin A initialising!")\r\nend\r\n\r\nfunction depends()\r\n  return "Plugin B"\r\nend\n'})})})]}),"\n",(0,a.jsxs)(n.p,{children:["To specify multiple dependencies, separate each with a comma. For native plugins this should result in a comma separated string. For Lua plugins, the ",(0,a.jsx)(n.code,{children:"depends"})," function can just return multiple strings:"]}),"\n",(0,a.jsxs)(s.A,{children:[(0,a.jsx)(l.A,{value:"cpp",label:"C++",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-cpp",children:'PLUGIN_ENTRY_POINT const char* VRTREE_APIENTRY VRPDepends()\r\n{\r\n  return "Plugin B, Plugin C";\r\n}\n'})})}),(0,a.jsx)(l.A,{value:"lua",label:"Lua",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-lua",children:'function depends()\r\n  return "Plugin B", "Plugin C"\r\nend\n'})})})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},79329:(e,n,r)=>{r.d(n,{A:()=>s});r(96540);var t=r(34164);const a={tabItem:"tabItem_Ymn6"};var i=r(74848);function s(e){let{children:n,hidden:r,className:s}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,t.A)(a.tabItem,s),hidden:r,children:n})}},65537:(e,n,r)=>{r.d(n,{A:()=>I});var t=r(96540),a=r(34164),i=r(65627),s=r(56347),l=r(50372),o=r(30604),u=r(11861),c=r(78749);function d(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:r}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:r,attributes:t,default:a}}=e;return{value:n,label:r,attributes:t,default:a}}))}(r);return function(e){const n=(0,u.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function h(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:r}=e;const a=(0,s.W6)(),i=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,o.aZ)(i),(0,t.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(a.location.search);n.set(i,e),a.replace({...a.location,search:n.toString()})}),[i,a])]}function g(e){const{defaultValue:n,queryString:r=!1,groupId:a}=e,i=p(e),[s,o]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!h({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=r.find((e=>e.default))??r[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[u,d]=m({queryString:r,groupId:a}),[g,f]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[a,i]=(0,c.Dv)(r);return[a,(0,t.useCallback)((e=>{r&&i.set(e)}),[r,i])]}({groupId:a}),b=(()=>{const e=u??g;return h({value:e,tabValues:i})?e:null})();(0,l.A)((()=>{b&&o(b)}),[b]);return{selectedValue:s,selectValue:(0,t.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),f(e)}),[d,f,i]),tabValues:i}}var f=r(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=r(74848);function x(e){let{className:n,block:r,selectedValue:t,selectValue:s,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:u}=(0,i.a_)(),c=e=>{const n=e.currentTarget,r=o.indexOf(n),a=l[r].value;a!==t&&(u(n),s(a))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=o.indexOf(e.currentTarget)+1;n=o[r]??o[0];break}case"ArrowLeft":{const r=o.indexOf(e.currentTarget)-1;n=o[r]??o[o.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":r},n),children:l.map((e=>{let{value:n,label:r,attributes:i}=e;return(0,v.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...i,className:(0,a.A)("tabs__item",b.tabItem,i?.className,{"tabs__item--active":t===n}),children:r??n},n)}))})}function P(e){let{lazy:n,children:r,selectedValue:i}=e;const s=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===i));return e?(0,t.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function y(e){const n=g(e);return(0,v.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(P,{...n,...e})]})}function I(e){const n=(0,f.A)();return(0,v.jsx)(y,{...e,children:d(e.children)},String(n))}},28453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>l});var t=r(96540);const a={},i=t.createContext(a);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);